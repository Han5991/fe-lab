---
title: '🚀 Next Step: 번들링과 스코프 (Step 3)'
status: 'To Do'
previous_step: 'Step 2 (AST & Graph)'
---

# 🚀 Next Step: 번들링과 스코프 (Step 3)

> **오늘의 성과**: 파일들을 찾아서 메모리에 올리는 것(Graph)까지 성공했습니다.
> **다음 목표**: 이제 메모리에 있는 파일들을 **진짜 실행 가능한 하나의 파일(`bundle.js`)**로 합쳐야 합니다.

## 🎯 핵심 학습 주제

다음 시간에는 **"그냥 합치면 망한다"**는 사실을 깨닫고, 이를 해결하는 기술들을 배웁니다.

### 1. 스코프 격리 (Scope Isolation)
*   **문제**: A파일의 `const name`과 B파일의 `const name`이 합쳐지면 충돌이 발생합니다.
*   **해결책**: **IIFE(즉시 실행 함수)**와 **Closure**를 사용하여 각 파일만의 독립된 공간(방)을 만들어줍니다.

### 2. 모듈 시스템 에뮬레이션
브라우저는 `require`나 `module.exports`를 모릅니다. 우리가 직접 이 기능들을 **함수로 구현(Shim)**해야 합니다.

*   **변환 (Transformation)**: `import` 문을 -> `require()` 함수 호출로 바꿉니다.
*   **런타임 (Runtime)**: `function require(id) { ... }`를 직접 구현해서 번들 파일 상단에 심어줍니다.

## 🛠️ 구현할 기능 (To-Do)

1.  **`transform()` 메서드 추가**:
    *   AST를 수정하여 ESM 문법(`import/export`)을 CommonJS 스타일로 변환합니다.
2.  **`bundle()` 메서드 구현**:
    *   각 모듈을 문자열 템플릿 함수로 감쌉니다.
    *   전체 모듈 맵을 순회하며 하나의 큰 문자열로 합칩니다.
3.  **파일 쓰기**:
    *   드디어 `dist/bundle.js`에 결과물을 저장합니다.
    *   브라우저에서 `index.html`을 열어 콘솔에 결과가 찍히는지 확인합니다.

---

## 🧠 미리 생각해보기 (Pre-Quiz)

다음 시간 시작 전에 가볍게 고민해보세요.

> "웹팩(Webpack)으로 빌드한 파일을 열어보면 왜 항상 `(function(modules) { ... })` 처럼 괄호로 시작할까요?"

수고하셨습니다! 다음 세션에서 만나요. 👋
